@inherits LayoutComponentBase
@inject IDataCacheService _dataCacheService

<MApp>
    <MAppBar App Color="@_dataCacheService.ThemeSetting.Theme" Dark Dense>
        <MAppBarNavIcon @onclick="@(()=>SetDrawer())"></MAppBarNavIcon>

        <CnGalWebSite.Shared.MasaComponent.App.Layout.TitleCard @ref="homeTitleCard" />
        <MSpacer></MSpacer>

        <CnGalWebSite.Shared.MasaComponent.Shared.Buttons.SearchButton Dark />
    </MAppBar>
    <CnGalWebSite.Shared.MasaComponent.App.Layout.NavButton Drawer="drawer" @ref="navButton" />

    <MMain>
        <MContainer>

            <CascadingValue Value="this" IsFixed="true">
                @Body
            </CascadingValue>

        </MContainer>
    </MMain>
</MApp>

@code {
    bool drawer { get; set; }
    CnGalWebSite.Shared.MasaComponent.App.Layout.TitleCard homeTitleCard;
    CnGalWebSite.Shared.MasaComponent.App.Layout.NavButton navButton;

    public async Task ChangeTitle(string title)
    {
        if (homeTitleCard != null)
        {
            await homeTitleCard.ChangeTitle(title);
        }
    }

    public async Task SetDrawer()
    {
        if (navButton != null)
        {
            await navButton.SetDrawer(true);
        }
    }
}
