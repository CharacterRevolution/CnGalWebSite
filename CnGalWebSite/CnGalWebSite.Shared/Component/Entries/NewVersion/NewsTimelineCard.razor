@if (Model.RelevancesState == EditState.Preview)
{
    <AlertTip Title="编辑关联信息" Type="AlertTip.AlertTipType.preview" Url="@("/entries/EditRelevances/" + Model.Id)" ExamineType="Operation.EstablishRelevances" OnClickRevoke="OnRevoke"></AlertTip>
}
<CnGalWebSite.Shared.MasaComponent.Shared.Components.MasaTitleContainer Title="动态" Icon="fa fa-fw fa-newspaper-o">
    <Timeline Items="AlternateTimelineItems" IsAlternate="true" />
</CnGalWebSite.Shared.MasaComponent.Shared.Components.MasaTitleContainer>

@code {
    [Parameter]
    public EntryIndexViewModel Model { get; set; }
    [Parameter]
    public EventCallback<Operation> OnRevoke { get; set; }
    private readonly List<TimelineItem> AlternateTimelineItems = new List<TimelineItem>();

    protected override async Task OnInitializedAsync()
    {
        //初始化动态时间线
        InitNewsTimeLine();
    }
    public Color GetColor(int index)
    {
        switch (index)
        {
            case 0:
                return Color.Primary;
            case 1:
                return Color.Info;
            case 2:
                return Color.Success;
            case 3:
                return Color.Warning;
            default:
                return Color.Danger;
        }
    }
    public void InitNewsTimeLine()
    {
        int next = 0;
        AlternateTimelineItems.Clear();
        foreach (var item in Model.NewsOfEntry.OrderByDescending(s => s.HappenedTime))
        {
            AlternateTimelineItems.Add(new TimelineItem
            {
                Color = GetColor((next++) % 4),
                Component = BootstrapDynamicComponent.CreateComponent<CnGalWebSite.Shared.Component.Entries.TimeLinePart>(new Dictionary<string, object>
                {
                    [nameof(CnGalWebSite.Shared.Component.Entries.TimeLinePart.Title)] = item.Title,
                    [nameof(CnGalWebSite.Shared.Component.Entries.TimeLinePart.BriefIntroduction)] = item.BriefIntroduction,
                    [nameof(CnGalWebSite.Shared.Component.Entries.TimeLinePart.HappenedTime)] = item.HappenedTime,
                    [nameof(CnGalWebSite.Shared.Component.Entries.TimeLinePart.Link)] = item.Link,
                }),
                Description = item.HappenedTime.ToString("yyyy-MM-dd")
            });
        }
    }

}
