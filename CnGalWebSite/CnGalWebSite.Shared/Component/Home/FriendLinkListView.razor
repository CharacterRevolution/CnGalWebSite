@inject ToastService ToastService
@inject HttpClient Http

@if (IsSmallScreen)
{
    <div class=" rounded shadow  bg-opacity rounded ps-3 pe-3 pt-3 pb-3 mb-2 mt-4" style="display: flex; flex-direction: row; justify-content: space-between;">
        <h2 class="fw-bold font-color h4" style="margin-bottom:auto;margin-top:auto;"><i class="fa fa-star"></i>&nbsp;&nbsp;友情链接</h2>
    </div>

    <div class="row">
        @for (int i = 0; i < Items.Count && i < ItemNum * 2; i++)
        {
            long temp = Items[i].Id;
            <div class="col-6 col-md-3 mb-2 mt-2">
                <div class="rounded shadow bg-opacity rounded pb-1 h-100">
                    <FriendLinkCardView Icon="fa fa-codepen" Id="temp" Image="@Items[i].Image" IsSmallScreen="true"
                                        Name="@Items[i].DisPlayName" Url="@Items[i].DisPlayValue"></FriendLinkCardView>
                </div>
            </div>
        }
    </div>

}
else
{
    <div class=" rounded shadow  bg-opacity rounded ps-4 pe-4 pt-3 pb-3 mt-4">
        <h2 class="fw-bold mb-4 font-color h4"><i class="fa fa-star"></i>&nbsp;&nbsp;友情链接</h2>
        @if (IsNormalScreen)
        {
            <div class="row">
                @for (int i = 0; i < Items.Count && i < ItemNum * 2; i++)
                {
                    long temp = Items[i].Id;
                    <div class="col-6 col-md-3 mb-2">
                        <FriendLinkCardView Icon="fa fa-codepen" Id="temp" Image="@Items[i].Image"
                                            Name="@Items[i].DisPlayName" Url="@Items[i].DisPlayValue"></FriendLinkCardView>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="row">
                @for (int i = 0; i < Items.Count && i < 12; i++)
                {
                    long temp = Items[i].Id;
                    <div class="col-12 col-md-6 col-lg-2 mb-2">
                        <FriendLinkCardView Icon="fa fa-codepen" Id="temp" Image="@Items[i].Image"
                                            Name="@Items[i].DisPlayName" Url="@Items[i].DisPlayValue"></FriendLinkCardView>
                    </div>
                }
            </div>
        }

    </div>
}


@code {
    int ItemNum = 4;

    public List<EntryHomeAloneViewModel> Items { get; set; } = new List<EntryHomeAloneViewModel>();

    [Parameter]
    public bool IsSmallScreen { get; set; }
    [Parameter]
    public bool IsNormalScreen { get; set; }
    [Parameter]
    public bool IsLargeScreen { get; set; }

    [CascadingParameter]
    public ErrorHandler ErrorHandler { get; set; }


    protected override async Task OnInitializedAsync()
    {
        if (Items.Count == 0)
        {
            try
            {
                //获取主页信息
                Items = await Http.GetFromJsonAsync<List<EntryHomeAloneViewModel>>(ToolHelper.WebApiPath + "api/home/GetHomeFriendLinksView");
                StateHasChanged();
            }
            catch (Exception ex)
            {
                ErrorHandler.ProcessError(ex, "获取主页友情链接列表失败");
            }
        }

    }
}
