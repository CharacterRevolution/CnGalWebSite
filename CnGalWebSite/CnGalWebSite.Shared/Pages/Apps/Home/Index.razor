@inject ToastService ToastService
@inject HttpClient Http
@inject IDataCacheService _dataCacheService

<TitleTip></TitleTip>

<CnGalWebSite.Shared.AppComponent.Pages.Home.ListCarousel />

<div style="width: 100%; margin-bottom: 50px;">
    <div class="tab-content" id="@("pills" + randomIndex + "-tabContent")">
        <div class="@("tab-pane fade" + (defaultIndex == 0 ? " show active " : "") )" id="@("pills" + randomIndex + "-0")" role="tabpanel" aria-labelledby="@("pills" + randomIndex + "-0-tab")">
            <div>
                <CnGalWebSite.Shared.AppComponent.Pages.Home.Index />
            </div>
        </div>
        <div class="@("tab-pane fade" + (defaultIndex == 1 ? " show active " : "") )" id="@("pills" + randomIndex + "-1")" role="tabpanel" aria-labelledby="@("pills" + randomIndex + "-1-tab")">

            @if (isReadyTab1)
            {
                <div>
                    <CnGalWebSite.Shared.AppComponent.Pages.Entries.Index />
                </div>
            }
        </div>
        <div class="@("tab-pane fade" + (defaultIndex == 2 ? " show active " : "") )" id="@("pills" + randomIndex + "-2")" role="tabpanel" aria-labelledby="@("pills" + randomIndex + "-2-tab")">
            @if (isReadyTab2)
            {
                <div>
                    <CnGalWebSite.Shared.AppComponent.Pages.Articles.Home />
                </div>
            }

        </div>
        <div class="@("tab-pane fade" + (defaultIndex == 3 ? " show active " : "") )" id="@("pills" + randomIndex + "-3")" role="tabpanel" aria-labelledby="@("pills" + randomIndex + "-3-tab")">
            @if (isReadyTab3)
            {
                <div>
                    <CnGalWebSite.Shared.AppComponent.Pages.Home.Others.Index />
                </div>
            }

        </div>
    </div>
</div>



<CnGalWebSite.Shared.AppComponent.Pages.Home.HomeFooter OnTabClick="OnTabClick" DefaultIndex="defaultIndex" RandomIndex="randomIndex" />

@code {

    private int defaultIndex { get; set; } = 0;
    [Parameter]
    public string DefaultIndex
    {
        get
        {
            return defaultIndex.ToString();
        }
        set
        {
            try
            {
                defaultIndex = int.Parse(value);
            }
            catch
            {
                defaultIndex = 0;
            }
        }

    }
    public int TabIndexNum = 0;
    public int randomIndex = new Random().Next();

    bool isReadyTab1 = false;
    bool isReadyTab2 = false;
    bool isReadyTab3 = false;

    protected override async Task OnInitializedAsync()
    {


    }


    public async Task OnTabClick(int index)
    {
        if (index == 1)
        {
            isReadyTab1 = true;
        }
        else if (index == 2)
        {
            isReadyTab2 = true;
        }
        else if (index == 3)
        {
            isReadyTab3 = true;
        }
        StateHasChanged();
        TabIndexNum = index;
    }
}
